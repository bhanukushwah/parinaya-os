---
phase: 01-multi-event-foundation-governance-controls
plan: "04"
type: execute
wave: 4
depends_on:
  - "01-02"
  - "01-03"
files_modified:
  - apps/web/src/routes/dashboard.tsx
  - apps/web/src/routes/dashboard.events.tsx
  - apps/web/src/routes/dashboard.audit.tsx
  - apps/web/src/routes/events.$eventId.tsx
  - apps/web/src/components/governance/access-denied.tsx
autonomous: true
user_setup: []
must_haves:
  truths:
    - "Parent Admin can manage multiple events from dashboard views and changes persist after refresh through API-backed queries."
    - "Invite-only events are hidden from public listings and unauthorized direct access shows friendly guided denial messaging."
    - "Operators can access a central audit page that shows required audit row details for governance-critical actions."
  artifacts:
    - path: apps/web/src/routes/dashboard.events.tsx
      provides: Event management UI (create/edit/archive/restore/reorder/visibility)
      min_lines: 140
      contains: createFileRoute("/dashboard/events")
    - path: apps/web/src/routes/dashboard.audit.tsx
      provides: Central audit page UI with filters and before/after summaries
      min_lines: 110
      contains: createFileRoute("/dashboard/audit")
    - path: apps/web/src/components/governance/access-denied.tsx
      provides: Friendly guided access-denied component for invite-only restrictions
      min_lines: 30
      contains: sign in
  key_links:
    - from: apps/web/src/routes/dashboard.events.tsx
      to: events router procedures
      via: oRPC query/mutation hooks for lifecycle and visibility operations
      pattern: orpc\.events
    - from: apps/web/src/routes/dashboard.audit.tsx
      to: audit router procedures
      via: oRPC query hook for central audit list
      pattern: orpc\.audit
    - from: apps/web/src/routes/events.$eventId.tsx
      to: apps/web/src/components/governance/access-denied.tsx
      via: unauthorized invite-only read fallback rendering
---

<objective>
Build minimum operator UI surfaces for event governance and audit visibility.

Purpose: Make Phase 1 backend guarantees usable by Parent Admin/Coordinator workflows and complete EVT-01/EVT-02/GOV-02 observable outcomes.
Output: Dashboard event management route, central audit route, and friendly invite-only access-denied UX.
</objective>

<execution_context>
@~/.kilocode/skills/execute-plan/SKILL.md
@.gsd/templates/summary.md
</execution_context>

<context>
@.gsd/ROADMAP.md
@.gsd/REQUIREMENTS.md
@.gsd/phases/01-multi-event-foundation-governance-controls/01-CONTEXT.md
@.gsd/phases/01-multi-event-foundation-governance-controls/01-RESEARCH.md
@.gsd/phases/01-multi-event-foundation-governance-controls/01-02-SUMMARY.md
@.gsd/phases/01-multi-event-foundation-governance-controls/01-03-SUMMARY.md
@apps/web/src/routes/dashboard.tsx
@apps/web/src/utils/orpc.ts
</context>

<tasks>
<task type="auto">
  <name>Task 1: Build dashboard event-management route using lifecycle APIs</name>
  <files>apps/web/src/routes/dashboard.events.tsx, apps/web/src/routes/dashboard.tsx</files>
  <action>Create `/dashboard/events` route with API-backed list and controls for create/edit/archive/restore/reorder/visibility updates. Keep operator flow focused for Parent Admin with clear status badges (draft/published/archived, public/invite-only). Wire mutations through oRPC and invalidate/refetch query data so changes persist and reappear after refresh. Update dashboard route to surface navigation entry points to events and audit pages.</action>
  <verify>`bun run check-types` passes and route tree compiles with new dashboard subroute.</verify>
  <done>Parent Admin can execute multi-event lifecycle operations from dashboard with persisted results.</done>
</task>

<task type="auto">
  <name>Task 2: Implement invite-only access flow with friendly guided denial component</name>
  <files>apps/web/src/routes/events.$eventId.tsx, apps/web/src/components/governance/access-denied.tsx</files>
  <action>Create direct event detail route that calls invite-only-safe detail API. Implement login-first behavior by redirecting unauthenticated users to login route before fetching protected data. For authenticated-but-ineligible responses, render friendly guided `AccessDenied` UI copy that explains next step without exposing role/escalation internals. Ensure invite-only events are not rendered in any public listing component.</action>
  <verify>`bun run check-types` succeeds and unauthorized states render typed fallback component paths.</verify>
  <done>Invite-only navigation path enforces auth then eligibility and displays friendly denial UX when blocked.</done>
</task>

<task type="auto">
  <name>Task 3: Build central audit page with required row details and routine-log visibility</name>
  <files>apps/web/src/routes/dashboard.audit.tsx</files>
  <action>Create `/dashboard/audit` route consuming audit list API. Render actor, timestamp, action, target, before/after summary, and optional reason. Add filter controls for action type and date-window for operational triage. Include routine action groups (`invite.send`, `guest.edit`) in list rendering so coordinator-facing operational logs are visible where allowed by backend policy.</action>
  <verify>`bun run check-types` and `bun run build` succeed for web app with audit UI route included.</verify>
  <done>Central audit UI is available in dashboard with actionable filtering and required row fidelity.</done>
</task>
</tasks>

<verification>
- [ ] `bun run check-types` succeeds across workspace after adding new web routes/components.
- [ ] `bun run build` succeeds for web app with new dashboard and event routes.
- [ ] `/dashboard/events` uses API data and supports lifecycle actions with post-mutation refresh.
- [ ] Invite-only unauthorized path renders friendly guided messaging and does not expose escalation details.
- [ ] `/dashboard/audit` displays action/actor/time/before-after details with filter controls.
</verification>

<success_criteria>
- All tasks completed.
- UI surfaces expose phase-01 governance capabilities without introducing out-of-scope product behavior.
- Phase goal behaviors are observable through dashboard/event routes tied to real API responses.
</success_criteria>

<output>
After completion, create `.gsd/phases/01-multi-event-foundation-governance-controls/01-04-SUMMARY.md`.
</output>
